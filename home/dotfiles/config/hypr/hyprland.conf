exec = hyprctl dispatch submap global # DO NOT REMOVE THIS OR YOU WON'T BE ABLE TO USE ANY KEYBIND
submap = global # This is required for catchall to work
ecosystem:no_update_news = true

# ============================================
#  MONITORS
# ============================================

monitor = , preferred, auto, 1
monitor = eDP-1, 2880x1800@60, auto, 1.3333
monitor = HDMI-A-1, preferred, auto, 1.0, mirror, eDP-1


# ============================================
#  ENVIRONMENT
# ============================================

env = ELECTRON_OZONE_PLATFORM_HINT, auto
env = QT_QPA_PLATFORM, wayland
env = QT_QPA_PLATFORMTHEME, kde
env = XDG_MENU_PREFIX, plasma-
env = TERMINAL, kitty -1


# ============================================
#  AUTOSTART
# ============================================

exec-once = hypridle
exec-once = hyprpaper
exec-once = swaync
exec-once = waybar
# exec-once = hyprlock
exec-once = dbus-update-activation-environment --all
exec-once = sleep 1 && dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
# exec-once = dex -a
exec-once = easyeffects --gapplication-service
exec-once = sway-audio-idle-inhibit
exec-once = pactl-listner
exec-once = bitwarden-handler
exec-once = polkit-gnome-authentication-agent-1


# ============================================
#  VARIABLES
# ============================================

$mainMod = SUPER
$altMod = ALT_L

$terminal = kitty
$fileManager = dolphin
$browser = firefox-beta
$editor = vscode
$lock = hyprlock
$closeSpecial = close-special-workspace


# ============================================
#  GENERAL
# ============================================

general {
    gaps_in = 5
    gaps_out = 20
    gaps_workspaces = 0
    border_size = 2
    
    col.active_border = rgba(928374ff) rgba(a89984ff) 45deg
    col.inactive_border = rgba(595959aa)
    
    resize_on_border = true
    no_focus_fallback = true
    allow_tearing = true

    snap {
        enabled = true
        window_gap = 4
        monitor_gap = 5
        respect_gaps = true
    }
}


# ============================================
#  LAYOUT
# ============================================

dwindle {
    preserve_split = true
    smart_split = false
    smart_resizing = false
}


# ============================================
#  DECORATION
# ============================================

decoration {
    #rounding = 18

    blur {
        enabled = true
        xray = true
        special = false
        new_optimizations = true
        size = 14
        passes = 3
        brightness = 1
        noise = 0.04
        contrast = 1
        popups = true
        popups_ignorealpha = 0.6
        input_methods = true
        input_methods_ignorealpha = 0.8
    }

    shadow {
        enabled = true
        ignore_window = true
        range = 30
        offset = 0 2
        render_power = 4
        color = rgba(00000010)
    }

    dim_inactive = true
    dim_strength = 0.025
    dim_special = 0.07
}


# ============================================
#  ANIMATIONS
# ============================================

animations {
    enabled = true

    bezier = expressiveFastSpatial, 0.42, 1.67, 0.21, 0.90
    bezier = expressiveSlowSpatial, 0.39, 1.29, 0.35, 0.98
    bezier = expressiveDefaultSpatial, 0.38, 1.21, 0.22, 1.00
    bezier = emphasizedDecel, 0.05, 0.7, 0.1, 1
    bezier = emphasizedAccel, 0.3, 0, 0.8, 0.15
    bezier = standardDecel, 0, 0, 0, 1
    bezier = menu_decel, 0.1, 1, 0, 1
    bezier = menu_accel, 0.52, 0.03, 0.72, 0.08

    animation = windowsIn, 1, 3, emphasizedDecel, popin 80%
    animation = windowsOut, 1, 2, emphasizedDecel, popin 90%
    animation = windowsMove, 1, 3, emphasizedDecel, slide
    animation = border, 1, 10, emphasizedDecel
    animation = layersIn, 1, 2.7, emphasizedDecel, popin 93%
    animation = layersOut, 1, 2.4, menu_accel, popin 94%
    animation = fadeLayersIn, 1, 0.5, menu_decel
    animation = fadeLayersOut, 1, 2.7, menu_accel
    animation = workspaces, 1, 7, menu_decel, slide
    animation = specialWorkspaceIn, 1, 2.8, emphasizedDecel, slidevert
    animation = specialWorkspaceOut, 1, 1.2, emphasizedAccel, slidevert
}


# ============================================
#  INPUT
# ============================================

input {
    kb_layout = us, ru
    kb_options = grp:alt_shift_toggle
    numlock_by_default = true
    repeat_delay = 250
    repeat_rate = 35

    follow_mouse = 1
    off_window_axis_events = 2
    mouse_refocus = false

    sensitivity = 0.2
    accel_profile = flat

    touchpad {
        scroll_factor = 0.5
        tap-to-click = false
        natural_scroll = true
        disable_while_typing = false
    }
}


# ============================================
#  GESTURES
# ============================================

gesture = 3, swipe, move
gesture = 4, horizontal, workspace
gesture = 4, pinch, float
gesture = 4, up, dispatcher, global, quickshell:overviewToggle
gesture = 4, down, dispatcher, global, quickshell:overviewClose

gestures {
    workspace_swipe_distance = 700
    workspace_swipe_cancel_ratio = 0.2
    workspace_swipe_min_speed_to_force = 5
    workspace_swipe_direction_lock = true
    workspace_swipe_direction_lock_threshold = 10
    workspace_swipe_create_new = true
}


# ============================================
#  MISC
# ============================================

misc {
    disable_hyprland_logo = true
    disable_splash_rendering = true
    background_color = rgba(101418FF)
    vfr = 1
    vrr = 1
    mouse_move_enables_dpms = true
    key_press_enables_dpms = true
    animate_manual_resizes = false
    animate_mouse_windowdragging = false
    enable_swallow = false
    swallow_regex = (foot|kitty|allacritty|Alacritty)
    new_window_takes_over_fullscreen = 2
    allow_session_lock_restore = true
    session_lock_xray = true
    initial_workspace_tracking = false
    focus_on_activate = true
}

binds {
    scroll_event_delay = 0
    hide_special_on_workspace_change = true
}

cursor {
    zoom_factor = 1
    zoom_rigid = false
    hotspot_padding = 1
}


# ============================================
#  PLUGINS
# ============================================

# plugin {
#     hyprexpo {
#         columns = 3
#         gap_size = 5
#         bg_col = rgb(000000)
#         workspace_method = first 1

#         enable_gesture = false
#         gesture_distance = 300
#         gesture_positive = false
#     }
# }


# ============================================
#  KEYBINDS - HARDWARE
# ============================================

bind = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bind = , XF86AudioLowerVolume, exec, wpctl set-volume @DEFAULT_AUDIO_SINK@ 5%-
bind = , XF86AudioRaiseVolume, exec, wpctl set-volume -l 1.0 @DEFAULT_AUDIO_SINK@ 5%+
bind = , XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bind = , XF86MonBrightnessDown, exec, brightnessctl set 5%-
bind = , XF86MonBrightnessUp, exec, brightnessctl set +5%
bind = , XF86SelectiveScreenshot, exec, grim -g "$(slurp)" - | wl-copy
bind = , Print, exec, grim - | wl-copy


# ============================================
#  KEYBINDS - GENERAL
# ============================================

bind = $mainMod, Q, killactive
bind = $mainMod, V, togglefloating
bind = $mainMod, J, togglesplit
bind = $mainMod, P, pseudo
bind = $mainMod, C, centerwindow
bind = $mainMod, F, fullscreen
bind = $mainMod, M, exit


# ============================================
#  KEYBINDS - APPLICATIONS
# ============================================

bind = $mainMod, RETURN, exec, $terminal
bind = SUPER_SHIFT, RETURN, exec, $terminal --class kitty-float
bind = $mainMod, L, exec, $lock
bind = $mainMod, SPACE, exec, $menu
bind = $mainMod, B, exec, $browser
bind = $mainMod, E, exec, $fileManager
bind = $mainMod, N, exec, kitty bash -c "cd /etc/nixos && nvim -c 'lua require(\"persistence\").load()'"


# ============================================
#  KEYBINDS - SCREENSHOTS
# ============================================

bind = $mainMod SHIFT, S, exec, grim -g "$(slurp)" - | wl-copy
bind = $mainMod, S, exec, grim - | wl-copy


# ============================================
#  KEYBINDS - RELOAD
# ============================================

bind = $mainMod SHIFT, B, exec, ~/.config/hypr/scripts/reload-hyprpaper.sh
bind = $mainMod SHIFT, L, exec, ~/.config/hypr/scripts/reload-hypridle.sh
bind = $mainMod SHIFT, W, exec, ~/.config/hypr/scripts/reload-waybar.sh


# ============================================
#  KEYBINDS - FOCUS
# ============================================

bind = $mainMod, left, movefocus, l
bind = $mainMod, right, movefocus, r
bind = $mainMod, up, movefocus, u
bind = $mainMod, down, movefocus, d


# ============================================
#  KEYBINDS - WORKSPACES
# ============================================

bind = $mainMod, 1, exec, $closeSpecial; hyprctl dispatch workspace 1
bind = $mainMod, 2, exec, $closeSpecial; hyprctl dispatch workspace 2
bind = $mainMod, 3, exec, $closeSpecial; hyprctl dispatch workspace 3
bind = $mainMod, 4, exec, $closeSpecial; hyprctl dispatch workspace 4
bind = $mainMod, 5, exec, $closeSpecial; hyprctl dispatch workspace 5
bind = $mainMod, 6, exec, $closeSpecial; hyprctl dispatch workspace 6
bind = $mainMod, 7, exec, $closeSpecial; hyprctl dispatch workspace 7
bind = $mainMod, 8, exec, $closeSpecial; hyprctl dispatch workspace 8
bind = $mainMod, 9, exec, $closeSpecial; hyprctl dispatch workspace 9
bind = $mainMod, 0, exec, $closeSpecial; hyprctl dispatch workspace 10

bind = $mainMod SHIFT, 1, movetoworkspace, 1
bind = $mainMod SHIFT, 2, movetoworkspace, 2
bind = $mainMod SHIFT, 3, movetoworkspace, 3
bind = $mainMod SHIFT, 4, movetoworkspace, 4
bind = $mainMod SHIFT, 5, movetoworkspace, 5
bind = $mainMod SHIFT, 6, movetoworkspace, 6
bind = $mainMod SHIFT, 7, movetoworkspace, 7
bind = $mainMod SHIFT, 8, movetoworkspace, 8
bind = $mainMod SHIFT, 9, movetoworkspace, 9
bind = $mainMod SHIFT, 0, movetoworkspace, 10

bind = $mainMod, A, togglespecialworkspace, magic
bind = $mainMod SHIFT, A, movetoworkspace, special:magic

bind = $mainMod, mouse_down, workspace, e+1
bind = $mainMod, mouse_up, workspace, e-1
bind = $mainMod, TAB, workspace, e+1
bind = SHIFT + $mainMod, TAB, workspace, e-1
bind = $altMod, TAB, exec, hyprctl dispatch cyclenext


# ============================================
#  KEYBINDS - MOUSE
# ============================================

bindm = $mainMod, mouse:272, movewindow
bindm = $mainMod, mouse:273, resizewindow


# ============================================
#  WINDOW RULES
# ============================================

windowrulev2 = noblur, class:^()$, title:^()$

windowrulev2 = center, title:^(Open File)(.*)$
windowrulev2 = float, title:^(Open File)(.*)$
windowrulev2 = center, title:^(Select a File)(.*)$
windowrulev2 = float, title:^(Select a File)(.*)$
windowrulev2 = center, title:^(Choose wallpaper)(.*)$
windowrulev2 = float, title:^(Choose wallpaper)(.*)$
windowrulev2 = size 60% 65%, title:^(Choose wallpaper)(.*)$
windowrulev2 = center, title:^(Open Folder)(.*)$
windowrulev2 = float, title:^(Open Folder)(.*)$
windowrulev2 = center, title:^(Save As)(.*)$
windowrulev2 = float, title:^(Save As)(.*)$
windowrulev2 = center, title:^(Library)(.*)$
windowrulev2 = float, title:^(Library)(.*)$
windowrulev2 = center, title:^(File Upload)(.*)$
windowrulev2 = float, title:^(File Upload)(.*)$
windowrulev2 = center, title:^(.*)(wants to save)$
windowrulev2 = float, title:^(.*)(wants to save)$
windowrulev2 = center, title:^(.*)(wants to open)$
windowrulev2 = float, title:^(.*)(wants to open)$
windowrulev2 = float, class:^(blueberry\.py)$
windowrulev2 = float, class:^(guifetch)$
windowrulev2 = float, class:^(pavucontrol)$
windowrulev2 = size 45%, class:^(pavucontrol)$
windowrulev2 = center, class:^(pavucontrol)$
windowrulev2 = stayfocused, class:^(pavucontrol)$
windowrulev2 = float, class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = size 45%, class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = center, class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = stayfocused, class:^(org.pulseaudio.pavucontrol)$
windowrulev2 = float, class:^(.blueman-manager-wrapped)$
windowrulev2 = size 45%, class:^(.blueman-manager-wrapped)$
windowrulev2 = center, class:^(.blueman-manager-wrapped)$
windowrulev2 = stayfocused, class:^(.blueman-manager-wrapped)$
windowrulev2 = float, class:^(nm-connection-editor)$
windowrulev2 = size 45%, class:^(nm-connection-editor)$
windowrulev2 = center, class:^(nm-connection-editor)$
windowrulev2 = float, class:.*plasmawindowed.*
windowrulev2 = float, class:kcm_.*
windowrulev2 = float, class:.*bluedevilwizard
windowrulev2 = float, title:.*Welcome
windowrulev2 = float, title:^(illogical-impulse Settings)$
windowrulev2 = float, title:.*Shell conflicts.*
windowrulev2 = float, class:org.freedesktop.impl.portal.desktop.kde
windowrulev2 = size 60% 65%, class:org.freedesktop.impl.portal.desktop.kde
windowrulev2 = float, class:^(Zotero)$
windowrulev2 = size 45%, class:^(Zotero)$

windowrulev2 = float, class:^(plasma-changeicons)$
windowrulev2 = noinitialfocus, class:^(plasma-changeicons)$
windowrulev2 = move 999999 999999, class:^(plasma-changeicons)$
windowrulev2 = move 40 80, title:^(Copying â€” Dolphin)$

windowrulev2 = tile, class:^dev\.warp\.Warp$

windowrulev2 = float, title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrulev2 = keepaspectratio, title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrulev2 = move 73% 72%, title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrulev2 = size 25%, title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$
windowrulev2 = pin, title:^([Pp]icture[-\s]?[Ii]n[-\s]?[Pp]icture)(.*)$

windowrulev2 = immediate, title:.*\.exe
windowrulev2 = immediate, title:.*minecraft.*
windowrulev2 = immediate, class:^(steam_app).*

windowrulev2 = noshadow, floating:0

windowrulev2 = idleinhibit always, fullscreenstate:* 2, focus:1

windowrulev2 = float, class:^(firefox-beta)$, title:.*Bitwarden.*


# ============================================
#  WORKSPACE RULES
# ============================================

workspace = special:special, gapsout:30


# ============================================
#  LAYER RULES
# ============================================

layerrule = xray 1, .*

layerrule = noanim, walker
layerrule = noanim, selection
layerrule = noanim, overview
layerrule = noanim, anyrun
layerrule = noanim, indicator.*
layerrule = noanim, osk
layerrule = noanim, hyprpicker
layerrule = noanim, noanim
layerrule = noanim, gtk4-layer-shell

layerrule = blur, gtk-layer-shell
layerrule = ignorezero, gtk-layer-shell
layerrule = blur, launcher
layerrule = ignorealpha 0.5, launcher
layerrule = blur, notifications
layerrule = ignorealpha 0.69, notifications
layerrule = blur, logout_dialog

layerrule = animation slide left, sideleft.*
layerrule = animation slide right, sideright.*
layerrule = blur, session[0-9]*
layerrule = blur, bar[0-9]*
layerrule = ignorealpha 0.6, bar[0-9]*
layerrule = blur, barcorner.*
layerrule = ignorealpha 0.6, barcorner.*
layerrule = blur, dock[0-9]*
layerrule = ignorealpha 0.6, dock[0-9]*
layerrule = blur, indicator.*
layerrule = ignorealpha 0.6, indicator.*
layerrule = blur, overview[0-9]*
layerrule = ignorealpha 0.6, overview[0-9]*
layerrule = blur, cheatsheet[0-9]*
layerrule = ignorealpha 0.6, cheatsheet[0-9]*
layerrule = blur, sideright[0-9]*
layerrule = ignorealpha 0.6, sideright[0-9]*
layerrule = blur, sideleft[0-9]*
layerrule = ignorealpha 0.6, sideleft[0-9]*
layerrule = blur, osk[0-9]*
layerrule = ignorealpha 0.6, osk[0-9]*

layerrule = blurpopups, quickshell:.*
layerrule = blur, quickshell:.*
layerrule = ignorealpha 0.79, quickshell:.*
layerrule = animation slide, quickshell:bar
layerrule = animation slide bottom, quickshell:cheatsheet
layerrule = noanim, quickshell:crosshair
layerrule = animation slide bottom, quickshell:dock
layerrule = animation popin 120%, quickshell:screenCorners
layerrule = noanim, quickshell:lockWindowPusher
layerrule = animation fade, quickshell:notificationPopup
layerrule = noanim, quickshell:overview
layerrule = animation slide bottom, quickshell:osk
layerrule = noanim, quickshell:screenshot
layerrule = blur, quickshell:session
layerrule = noanim, quickshell:session
layerrule = ignorealpha 0, quickshell:session
layerrule = animation slide right, quickshell:sidebarRight
layerrule = animation slide left, quickshell:sidebarLeft
layerrule = animation slide, quickshell:verticalBar
layerrule = animation slide top, quickshell:wallpaperSelector
